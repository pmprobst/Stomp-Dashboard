<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stomp Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Stomp Dashboard</h1>
            <p class="subtitle">Card Game Score Tracker</p>
        </header>

        <!-- Navigation: Restart Game | Undo Last Round | Game History -->
        <nav class="navigation">
            <div class="nav-container">
                <button class="nav-btn" id="restartGameBtn" data-page="setup">Restart Game</button>
                <button class="nav-btn" id="undoLastBtn">Undo Last Round</button>
                <button class="nav-btn" data-page="history">Game History</button>
            </div>
        </nav>

        <!-- Game Setup Page -->
        <section id="setup" class="page active">
            <div class="card">
                <h2>Game Setup</h2>
                <div class="setup-form">
                    <div class="form-group">
                        <label for="playerCount">Number of Players (2-20):</label>
                        <input type="number" id="playerCount" min="2" max="20" value="4">
                    </div>

                    <div class="game-config">
                        <h3>Game Configuration</h3>
                        <div class="config-grid">
                            <div class="form-group">
                                <label for="totalRounds">Total Rounds:</label>
                                <input type="number" id="totalRounds" min="1" max="20" value="10">
                            </div>
                            <div class="form-group">
                                <label for="basePoints">Base Points (Round 1):</label>
                                <input type="number" id="basePoints" min="1" max="100" value="10">
                            </div>
                            <div class="form-group">
                                <label for="pointsIncrement">Points Increment per Round:</label>
                                <input type="number" id="pointsIncrement" min="1" max="50" value="10">
                            </div>
                        </div>
                    </div>

                    <div id="playerNames" class="player-names">
                        <!-- Player name inputs will be generated here -->
                    </div>
                    <button id="startGame" class="btn btn-primary">Start Game</button>
                </div>
            </div>
        </section>

        <!-- Game Page: dashboard strip + scoreboard OR round entry -->
        <section id="game" class="page">
            <!-- Live dashboard strip (always visible when game page is shown) -->
            <div class="card round-progress">
                <h3>Round Progress</h3>
                <div class="progress-info">
                    <div class="round-display">
                        <span class="round-number">Round <span id="currentRound">1</span> of <span id="totalRoundsDisplay">10</span></span>
                        <span class="trick-worth">Tricks worth <span id="trickWorth">10</span> points each</span>
                    </div>
                    <div class="tricks-info">
                        <span>Tricks in this round: <span id="tricksInRound">10</span></span>
                    </div>
                </div>
                <div class="progress-bar">
                    <div id="roundProgress" class="progress-fill"></div>
                </div>
            </div>

            <!-- Next Round button (shown only when scoreboard is visible) -->
            <div id="nextRoundButtonRow" class="next-round-row" style="display: none;">
                <button id="nextRoundBtn" class="btn btn-success btn-next-round">Next Round</button>
            </div>

            <!-- Scoreboard block (shown after each round) -->
            <div id="gameScoreboardBlock" class="game-block" style="display: none;">
                <div class="card scoreboard">
                    <h3>Live Scoreboard</h3>
                    <div class="threshold-selector">
                        <div class="threshold-controls">
                            <div class="threshold-group">
                                <label for="topThreshold">Top Players:</label>
                                <input type="number" id="topThreshold" min="1" max="20" value="3" class="threshold-input">
                            </div>
                            <div class="threshold-group">
                                <label for="bottomThreshold">Bottom Players:</label>
                                <input type="number" id="bottomThreshold" min="1" max="20" value="3" class="threshold-input">
                            </div>
                            <button id="updateThresholds" class="btn btn-primary">Update Display</button>
                        </div>
                    </div>
                    <div class="scoreboard-grid">
                        <div class="top-players">
                            <h4>Top <span id="topThresholdDisplay">3</span> Players</h4>
                            <div id="topPlayers" class="player-list"></div>
                        </div>
                        <div class="bottom-players">
                            <h4>Bottom <span id="bottomThresholdDisplay">3</span> Players</h4>
                            <div id="bottomPlayers" class="player-list"></div>
                        </div>
                    </div>
                    <div class="full-rankings">
                        <h4>Full Rankings</h4>
                        <div id="fullRankings" class="rankings-table"></div>
                    </div>
                </div>
            </div>

            <!-- Round entry block (bets + tricks + summary) -->
            <div id="gameRoundEntryBlock" class="game-block">
                <div class="card bet-phase" id="betPhase">
                    <h3>Round <span id="roundInputNumber">1</span> - Betting Phase</h3>
                    <p class="phase-description">Enter each player's bet for this round.</p>
                    <div id="betInputForm" class="bet-form">
                        <!-- Bet input form will be generated here -->
                    </div>
                    <div class="round-actions">
                        <button id="submitBets" class="btn btn-success">Submit Bets</button>
                    </div>
                </div>

                <div class="card trick-phase" id="trickPhase" style="display: none;">
                    <h3>Round <span id="trickRoundNumber">1</span> - Trick Playing Phase</h3>
                    <div class="trick-progress">
                        <p>Trick <span id="currentTrick">1</span> of <span id="totalTricks">10</span></p>
                        <div class="trick-progress-bar">
                            <div id="trickProgressFill" class="trick-progress-fill"></div>
                        </div>
                    </div>
                    <div class="trick-selection">
                        <label for="trickWinner">Who won this trick?</label>
                        <select id="trickWinner" class="trick-winner-select">
                            <option value="">Select winner...</option>
                        </select>
                        <button id="submitTrickWinner" class="btn btn-primary">Submit Trick Winner</button>
                    </div>
                    <div class="trick-actions">
                        <button id="undoLastTrick" class="btn btn-warning">Undo Last Trick</button>
                    </div>
                    <div class="trick-history">
                        <h4>Trick History</h4>
                        <div id="trickHistory" class="trick-history-list"></div>
                    </div>
                </div>

                <div class="card round-summary">
                    <h3>Round Summary</h3>
                    <div id="roundSummary" class="summary-content"></div>
                </div>
            </div>
        </section>

        <!-- Game History Page -->
        <section id="history" class="page">
            <div class="card game-history">
                <h3>Game History</h3>
                <div id="gameHistory" class="history-content"></div>
            </div>
        </section>

        <!-- Validation Error Modal -->
        <div id="errorModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Validation Error</h3>
                <p id="errorMessage"></p>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
